import mongoose from 'mongoose';

const Schema = mongoose.Schema;

// --- Content Schema ---
// Stores each individual piece of generated content
const contentSchema = new Schema({
  userId: {
    type: String,
    required: true,
    index: true // Add index for faster queries by user
  },
  topic: {
    type: String,
    required: true,
    trim: true
  },
  contentType: {
    type: String,
    required: true,
    enum: [
      'YouTube Shorts',
      'Instagram Reel',
      'TikTok',
      'LinkedIn Post',
      'Blog Post',
      'Twitter Thread'
    ]
  },
  tone: {
    type: String,
    required: true,
    enum: [
      'Casual',
      'Professional',
      'Humorous',
      'Motivational',
      'Educational',
      'Gen-Z Slang'
    ]
  },
  targetAudience: {
    type: String,
    required: true,
    trim: true
  },
  theme: {
    type: String,
    required: true,
    enum: [
      'Educational',
      'Motivational',
      'Business',
      'Lifestyle',
      'Entertainment',
      'Tech'
    ]
  },
  generatedScript: {
    type: String,
    required: true
  },
  generatedCaption: {
    type: String
  },
  generatedHashtags: {
    type: [String] // Storing hashtags as an array
  },
  generatedThumbnailPrompt: {
    type: String
  },
  audioSuggestion: {
    type: String
  }
}, {
  timestamps: true // Adds createdAt and updatedAt automatically
});

// Add index on createdAt for sorting history
contentSchema.index({ createdAt: -1 });

export const Content = mongoose.model('Content', contentSchema);

// --- User Profile Schema ---
// Stores user-specific preferences and metadata
const userProfileSchema = new Schema({
  userId: {
    type: String,
    required: true,
    unique: true, // Each user has one profile
    index: true
  },
  username: {
    type: String,
    trim: true
  },
  brandName: {
    type: String,
    trim: true
  },
  brandVoice: {
    type: String,
    trim: true
  },
  targetAudience: {
    type: String,
    trim: true
  },
  industryFocus: {
    type: String,
    trim: true
  },
  preferredPlatforms: {
    type: [String]
  },
  generationCount: {
    type: Number,
    default: 0
  }
}, {
  timestamps: true
});

export const UserProfile = mongoose.model('UserProfile', userProfileSchema);